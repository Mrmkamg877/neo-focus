<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#6C5CE7">
    <meta name="description" content="Ultra-focus task manager">
    <title>NEO Focus âš¡</title>
    <link rel="manifest" href="/manifest.webmanifest">
    <link rel="icon" href="/icon-192.png" type="image/png">
    <style>
        /* [Previous CSS styles remain exactly the same] */
    </style>
</head>
<body>
    <!-- [Previous HTML content remains exactly the same] -->

    <script>
        // ===== SERVICE WORKER REGISTRATION =====
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    const registration = await navigator.serviceWorker.register('/sw.js');
                    console.log('ServiceWorker registration successful');
                } catch (err) {
                    console.log('ServiceWorker registration failed: ', err);
                }
            });
        }

        // ===== INSTALL PROMPT =====
        let deferredPrompt;
        const installContainer = document.getElementById('installContainer');
        const installBtn = document.getElementById('installBtn');
        const dismissBtn = document.getElementById('dismissBtn');

        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent Chrome 67 and earlier from automatically showing the prompt
            e.preventDefault();
            // Stash the event so it can be triggered later
            deferredPrompt = e;
            
            // Show the install button
            setTimeout(() => {
                installContainer.style.display = 'block';
            }, 3000);
            
            // Optionally, send analytics event that PWA install promo was shown
            console.log('PWA install prompt available');
        });

        installBtn.addEventListener('click', async () => {
            // Hide the install prompt
            installContainer.style.display = 'none';
            
            // Show the install prompt
            deferredPrompt.prompt();
            
            // Wait for the user to respond to the prompt
            const { outcome } = await deferredPrompt.userChoice;
            
            // Optionally, send analytics event with outcome
            console.log(`User response to the install prompt: ${outcome}`);
            
            // We've used the prompt, and can't use it again, throw it away
            deferredPrompt = null;
        });

        dismissBtn.addEventListener('click', () => {
            installContainer.style.display = 'none';
            // Show again after 24 hours
            setTimeout(() => {
                if (deferredPrompt) {
                    installContainer.style.display = 'block';
                }
            }, 86400000);
        });

        // Check if app is already installed
        window.addEventListener('appinstalled', (evt) => {
            // Hide the install prompt
            installContainer.style.display = 'none';
            // Log install to analytics
            console.log('PWA was installed');
        });

        // [Rest of your JavaScript code remains the same]
    </script>
</body>
</html>
